# 個人チャット

- 友達登録

  - 送信元ユーザーのユーザーレコードを DB に新たに作成（既に存在していれば追加はしない）
  - bot の自己紹介メッセージを送信する
  - 送信元ユーザーにリッチメニューをセットする

- 友達解除
  - DB から送信元ユーザーに対応するユーザーレコードを削除する

## コメント送信

- `_exit`
  - 送信元ユーザーのモードを待機モードに変更
  - スタートメッセージを送信
- `_mode`
  - 送信元ユーザーのモードを送信
- `_payment`
  - 支払い機能が未実装である旨のメッセージを送信
- `_analysis`
  - 分析機能が未実装である旨のメッセージを送信
- `_fortune`
  - 占い結果を送信
- `_history`
  - 履歴機能が未実装である旨のメッセージを送信
- `_help`
  - bot の使い方を送信
- `_setting`
  - 個人設定機能が未実装である旨のメッセージを送信
- `_github`
  - 雀マネの github url を送信

### ポストバック

- ``

コマンド以外は送信元ユーザーのモードによって変化

### 待機モード

- プレーンテキスト
  - bot の呟きをランダムに送信する
- その他の形式のチャット
  - 対応してない旨のメッセージを送信する

## リッチメニュー

- 支払い機能ボタンを押下
- 対戦履歴機能ボタンを押下
- 分析機能ボタンを押下
- 設定機能ボタンを押下
- 使い方機能ボタンを押下
- 占い機能ボタンを押下

# ルームチャット

- ルームに bot を追加
  - 追加したルームのルームレコードを DB に新たに作成
  - 自己紹介メッセージ（友達追加案内）を送信
  - スタートメッセージを送信

## チャット送信

- `_start`
  - スタートメニューを送信
- `_exit`
  - ルームの active な半荘レコードを disabled にする
  - ルームのモードを待機モードに変更
  - スタートメッセージを送信
- `_input`
  - ルームのモードを点数入力モードにし、入力開始メッセージを送信
- `_mode`
  - ルームのモードを送信
- `_help`
  - 使い方メッセージを送信
- `_setting`
  - 設定メニューを送信
- `_results`
  - ルームの active なマッチの全半荘結果を送信
- `_finish`
  - ルームの active なマッチの全半荘集計結果を送信
  - ルームの active なマッチを disabled にする
- `_fortune`
  - 送信元ユーザーの占い結果を送信
- `_others`
  - その他の設定メニューを送信
- `_matches`
  - ルームの最近 4 回のマッチの結果を送信
- `_match 1`
  - match id が 1 の結果を送信
- `_drop 1`
  - ルームの active なマッチの 1 個目の半荘結果を削除
  - 削除した旨を送信
- `_drop_m`
  - ルームの active なマッチを disabled にする
  - ルームの active なマッチを disabled にした旨を送信
- `_drop_m 1`
  - match id が 1 のマッチを削除
- `_add_result {json}`
  - json テキストを元に半荘レコードを作成
  - 現在アクティブなマッチ（なければ作成）に半荘を追加
  - 作成した結果を送信
- `_sum_matches`
- `_graph`
  - グラフ機能は未実装の旨を送信

### ポストバック

- `_tobi`
- `_setting`
- `_update_config`

# その他

サーバー接続エラー
